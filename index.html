<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Elite Digitális Tolómérő</title>
    <style>
        :root { --accent: #30d158; --bg: #000; }
        body { background: var(--bg); color: #fff; font-family: sans-serif; margin: 0; overflow: hidden; touch-action: none; }
        
        /* Kalibrációs képernyő */
        #overlay { position: fixed; inset: 0; background: #000; z-index: 2000; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        input { background: #1a1a1a; border: 1px solid var(--accent); color: #fff; padding: 12px; border-radius: 8px; width: 250px; margin: 10px 0; font-size: 16px; text-align: center; }
        button { background: var(--accent); color: #000; border: none; padding: 15px 30px; border-radius: 10px; font-weight: bold; cursor: pointer; }

        /* Mérőfelület */
        #canvas { display: none; width: 100vw; height: 100vh; position: relative; }
        
        /* Fix vonalzók a széleken */
        .ruler-h { position: absolute; top: 0; left: 0; height: 40px; width: 100%; border-bottom: 1px solid #333; }
        .ruler-v { position: absolute; top: 0; left: 0; width: 40px; height: 100%; border-right: 1px solid #333; }

        /* A mérő téglalap */
        #box { 
            position: absolute; top: 100px; left: 100px; 
            width: 75px; height: 75px; /* Alap 20mm körüli méret */
            border: 2px solid var(--accent); background: rgba(48, 209, 88, 0.1);
            box-sizing: border-box;
        }
        #handle { 
            position: absolute; bottom: -15px; right: -15px; 
            width: 30px; height: 30px; background: var(--accent); 
            border-radius: 50%; border: 5px solid #000;
        }
        #label { 
            position: absolute; top: -25px; left: 0; 
            font-size: 14px; color: var(--accent); font-weight: bold; white-space: nowrap;
        }

        /* Kézi bevitel panel */
        #manual-input {
            position: fixed; bottom: 20px; right: 20px; background: rgba(26,26,26,0.8);
            padding: 10px; border-radius: 12px; display: flex; gap: 5px; border: 1px solid #333;
        }
        .small-in { width: 60px !important; margin: 0 !important; padding: 5px !important; font-size: 12px !important; }
    </style>
</head>
<body>

<div id="overlay">
    <h2>Elite Méretező</h2>
    <input type="number" id="ppiInput" value="243" placeholder="PPI érték">
    <button onclick="initApp()">INDÍTÁS</button>
    <p style="font-size: 12px; color: #666; margin-top: 20px;">Tab S7 FE: 243 | Note 20 Ultra: 496</p>
</div>

<div id="canvas">
    <div id="box">
        <div id="label">20 x 20 mm</div>
        <div id="handle"></div>
    </div>

    <div id="manual-input">
        <input type="number" id="m-w" class="small-in" placeholder="Szél.">
        <input type="number" id="m-h" class="small-in" placeholder="Mag.">
        <button onclick="setManual()" style="padding: 5px 10px; font-size: 12px;">OK</button>
    </div>
</div>

<script>
    let ppmm = 1;
    const box = document.getElementById('box');
    const handle = document.getElementById('handle');
    const label = document.getElementById('label');
    const canvas = document.getElementById('canvas');

    function initApp() {
        const ppi = document.getElementById('ppiInput').value;
        ppmm = ppi / 25.4;
        document.getElementById('overlay').style.display = 'none';
        canvas.style.display = 'block';
        updateLabel(box.offsetWidth, box.offsetHeight);
    }

    // Manuális beállítás mm-ben
    function setManual() {
        const w = document.getElementById('m-w').value;
        const h = document.getElementById('m-h').value;
        if(w) box.style.width = (w * ppmm) + "px";
        if(h) box.style.height = (h * ppmm) + "px";
        updateLabel(box.offsetWidth, box.offsetHeight);
    }

    function updateLabel(pxW, pxH) {
        const mmW = (pxW / ppmm).toFixed(1);
        const mmH = (pxH / ppmm).toFixed(1);
        label.innerText = `${mmW} mm × ${mmH} mm`;
    }

    // Drag & Resize logika (Tollal és ujjal is megy)
    let isResizing = false;

    handle.addEventListener('pointerdown', (e) => {
        isResizing = true;
        e.stopPropagation();
        handle.setPointerCapture(e.pointerId);
    });

    window.addEventListener('pointermove', (e) => {
        if (!isResizing) return;
        
        const rect = box.getBoundingClientRect();
        let newWidth = e.clientX - rect.left;
        let newHeight = e.clientY - rect.top;

        // Minimum méret (5mm)
        if (newWidth < 5 * ppmm) newWidth = 5 * ppmm;
        if (newHeight < 5 * ppmm) newHeight = 5 * ppmm;

        box.style.width = newWidth + "px";
        box.style.height = newHeight + "px";
        
        updateLabel(newWidth, newHeight);
    });

    window.addEventListener('pointerup', () => {
        isResizing = false;
    });

</script>
</body>
</html>
